<form [formGroup]="expenseForm" (ngSubmit)="onSubmit()">
    <mat-form-field appearance="outline" style="flex: 1;">
        <mat-label>Expense Name</mat-label>
        <input matInput placeholder=" Expense Name" type="text" formControlName="expenseName" />
    </mat-form-field>
    <mat-form-field appearance="outline">
        <mat-label>Amount</mat-label>
        <input matInput placeholder="Amount" type="number" formControlName="amount" />
    </mat-form-field>
    <mat-card appearance="outlined" formArrayName="participants">
        @for (item of indexedParticipants(); track item.participant) {
        <mat-checkbox [formControlName]="item.index">{{ item.participant.userName }}</mat-checkbox>
        }
    </mat-card>

    <div>
        @if (error) {
        <mat-error style="margin-bottom: 10px;">{{error}}</mat-error>
        }
        <button matButton="filled" type="submit" [disabled]="loading()">
            @if(loading()) {
            <mat-spinner diameter="20"></mat-spinner>
            } @else {
            Add
            }</button>
    </div>
</form>

@if (expenses().length > 0) {
@for (expense of expenses(); track expense) {
<mat-card appearance="outlined" style="margin-top: 20px;">
    <mat-card-header>
        <mat-card-title-group>
            <mat-card-title>
                {{ expense.expenseName }}
            </mat-card-title>
            <mat-card-subtitle>
                {{ expense.payerUsername }} payed
                {{ expense.amount }} euro
            </mat-card-subtitle>
        </mat-card-title-group>
    </mat-card-header>

    <mat-card-content>
        @for (participant of expense.expenseParticipant; track participant) {
        Participants: <span>{{ participant.userName }}</span>
        }
    </mat-card-content>
</mat-card>
}
} @else {
<h3 style="margin-top: 20px;">No expenses yet</h3>
}